CREATE TABLE PERSONA(
    
	ID_PERSONA INT AUTO_INCREMENT NOT NULL,
    APELLIDO_PATERNO VARCHAR(30) NOT NULL,
    APELLIDO_MATERNO VARCHAR(30) NOT NULL,
    NOMBRE VARCHAR(30) NOT NULL,
    DNI VARCHAR(30) NOT NULL,
    DIRECCION VARCHAR(30) NOT NULL,
    TELEFONO VARCHAR(30) NOT NULL,
    CORREO VARCHAR(30) NOT NULL,
    
    CONSTRAINT pk_id_persona PRIMARY KEY (ID_PERSONA)
);

CREATE TABLE CLIENTE(
    
	ID_CLIENTE INT AUTO_INCREMENT NOT NULL,
    ID_PERSONA INT NOT NULL,
    
    CONSTRAINT pk_id_cliente PRIMARY KEY (ID_CLIENTE),
    CONSTRAINT fk_id_persona FOREIGN KEY (ID_PERSONA) REFERENCES PERSONA(ID_PERSONA)
    
);

CREATE TABLE TIPO_USUARIO(
	ID_TIPO_USU INT AUTO_INCREMENT NOT NULL,
    NOM_TIPO_USU VARCHAR(30) NOT NULL,
    
    CONSTRAINT pk_id_tipo_usu PRIMARY KEY (ID_TIPO_USU)
);

CREATE TABLE USUARIO(
	ID_USUARIO INT AUTO_INCREMENT NOT NULL,
    USARIO VARCHAR(30) NOT NULL,
    PASS VARCHAR(30) NOT NULL,
    ID_TIPO_USU INT NOT NULL,
    
    CONSTRAINT pk_id_usu PRIMARY KEY (ID_USUARIO),
	CONSTRAINT fk_id_tipo_usu FOREIGN KEY (ID_TIPO_USU) REFERENCES TIPO_USUARIO (ID_TIPO_USU)   
);

CREATE TABLE TARIFA(
	ID_TARIFA INT AUTO_INCREMENT NOT NULL,
    TEMPORADA VARCHAR(30) NOT NULL,
    PRECIO DOUBLE NOT NULL,
    FECHA_DESDE DATE NOT NULL,
    FECHA_HASTA DATE NOT NULL,
    
    CONSTRAINT pk_id_tarifa PRIMARY KEY (ID_TARIFA)
);

CREATE TABLE TIPO_HABITACION(
	ID_TIPO_HABITACION INT AUTO_INCREMENT NOT NULL,
    DESCRIPCION VARCHAR(30) NOT NULL,
    ID_TARIFA INT NOT NULL,
    
    CONSTRAINT pk_id_tipo_hab PRIMARY KEY (ID_TIPO_HABITACION),
    CONSTRAINT fk_id_tarifa FOREIGN KEY (ID_TARIFA) REFERENCES TARIFA(ID_TARIFA)
);


CREATE TABLE PROVINCIA(
    
	ID_PROVINCIA INT AUTO_INCREMENT NOT NULL,
    NOMBRE VARCHAR(30) NOT NULL,
    
    CONSTRAINT pk_id_provincia PRIMARY KEY (ID_PROVINCIA)
);

CREATE TABLE HOTEL (

    ID_HOTEL INT AUTO_INCREMENT NOT NULL,
    NOMBRE VARCHAR(30) NOT NULL,
    ID_PROVINCIA INT NOT NULL,
    
    CONSTRAINT pk_id_hotel PRIMARY KEY (ID_HOTEL),
    CONSTRAINT fk_id_provincia FOREIGN KEY (ID_PROVINCIA) REFERENCES PROVINCIA(ID_PROVINCIA)
    
);

CREATE TABLE HABITACION(
	ID_HABITACION INT AUTO_INCREMENT NOT NULL,
    NOMBRE_HABITACION VARCHAR(30) NOT NULL,
    DESCRIPCION VARCHAR(100) NOT NULL,
    ESTADO VARCHAR(30) NOT NULL,
    PLAZAS INT NOT NULL,
    ID_TIPO_HABITACION INT NOT NULL,
    ID_HOTEL INT NOT NULL,
    
    CONSTRAINT pk_id_habitacion PRIMARY KEY (ID_HABITACION),
    CONSTRAINT fk_id_tipo_hab FOREIGN KEY (ID_TIPO_HABITACION) REFERENCES TIPO_HABITACION(ID_TIPO_HABITACION),
    CONSTRAINT fk2_id_hotel FOREIGN KEY (ID_HOTEL) REFERENCES HOTEL (ID_HOTEL)
    
);

CREATE TABLE RESERVA(
    
	ID_RESERVA INT AUTO_INCREMENT NOT NULL,
    FECHA_INICIO DATE NOT NULL,
    FECHA_FIN DATE NOT NULL,
    CANTIDAD INT NOT NULL,
    ESTADO VARCHAR(30) NOT NULL,
    ID_CLIENTE INT NOT NULL,
    ID_HABITACION INT NOT NULL,
    
    CONSTRAINT pk_id_reserva PRIMARY KEY (ID_RESERVA),
    CONSTRAINT fk_id_cliente FOREIGN KEY (ID_CLIENTE) REFERENCES CLIENTE(ID_CLIENTE),
    CONSTRAINT fk_id_habitacion FOREIGN KEY (ID_HABITACION) REFERENCES HABITACION (ID_HABITACION)

);

CREATE TABLE EMPLEADO(
    
    ID_EMPLEADO INT AUTO_INCREMENT NOT NULL,
    ID_PERSONA INT NOT NULL,
    ID_HOTEL INT NOT NULL,
    ID_USUARIO INT NOT NULL,
    
    CONSTRAINT pk_id_empledo PRIMARY KEY (ID_EMPLEADO),
    CONSTRAINT fk2_id_persona FOREIGN KEY (ID_PERSONA) REFERENCES PERSONA(ID_PERSONA),
    CONSTRAINT fk_id_hotel FOREIGN KEY (ID_HOTEL) REFERENCES HOTEL(ID_HOTEL),
    CONSTRAINT fk_id_usuario FOREIGN KEY (ID_USUARIO) REFERENCES USUARIO(ID_USUARIO)
);


CREATE TABLE HOSPEDAJE(
	
    ID_HOSPEDAJE INT AUTO_INCREMENT NOT NULL,
    ESTADO VARCHAR(30) NOT NULL,
    ID_EMPLEADO INT NOT NULL,
    ID_CLIENTE INT NOT NULL,
    
    CONSTRAINT pk_id_hospedaje PRIMARY KEY (ID_HOSPEDAJE),
    CONSTRAINT fk_id_empleado FOREIGN KEY (ID_EMPLEADO) REFERENCES EMPLEADO (ID_EMPLEADO),
  	CONSTRAINT fk2_id_cliente FOREIGN KEY (ID_CLIENTE) REFERENCES CLIENTE(ID_CLIENTE) 
);

CREATE TABLE DETALLE_HOSPEDAJE_HAB(
	
    ID_DETALLE_HOSPEDAJE_HAB INT AUTO_INCREMENT NOT NULL,
    FECHA_INICIO DATE NOT NULL,
    FECHA_FIN DATE NOT NULL,
    ID_HABITACION INT NOT NULL,
	ID_HOSPEDAJE INT NOT NULL,
    
    CONSTRAINT pk_id_detalle_hospedaje_hab PRIMARY KEY (ID_DETALLE_HOSPEDAJE_HAB),
    CONSTRAINT fk2_id_habitacion FOREIGN KEY (ID_HABITACION) REFERENCES HABITACION(ID_HABITACION),
    CONSTRAINT fk_id_hospedaje FOREIGN KEY (ID_HOSPEDAJE) REFERENCES HOSPEDAJE(ID_HOSPEDAJE)
    
);

CREATE TABLE PRODUCTO(

    ID_PRODUCTO INT AUTO_INCREMENT NOT NULL,
    DESCRIPCION VARCHAR(30) NOT NULL,
    PRECIO DOUBLE NOT NULL,
    
    CONSTRAINT pk_id_producto PRIMARY KEY (ID_PRODUCTO)
	
);

CREATE TABLE CONSUMO(
	
    ID_CONSUMO INT AUTO_INCREMENT NOT NULL,
    CANTIDAD INT NOT NULL,
    SUBTOTAL INT NOT NULL,
    ID_DETALLE_HOSPEDAJE_HAB INT NOT NULL,
    ID_PRODUCTO INT NOT NULL,
    
    CONSTRAINT pk_id_consumo PRIMARY KEY(ID_CONSUMO),
    CONSTRAINT fk_id_detalle_hospedaje_hab FOREIGN KEY (ID_DETALLE_HOSPEDAJE_HAB) REFERENCES DETALLE_HOSPEDAJE_HAB (ID_DETALLE_HOSPEDAJE_HAB),
    CONSTRAINT fk_id_producto FOREIGN KEY (ID_PRODUCTO) REFERENCES PRODUCTO (ID_PRODUCTO)

);

CREATE TABLE FORMA_PAGO(
	
    ID_FORMA_PAGO INT AUTO_INCREMENT NOT NULL,
    NOMBRE VARCHAR(30) NOT NULL,
    
    CONSTRAINT pk_id_forma_pago PRIMARY KEY (ID_FORMA_PAGO)
    
);

CREATE TABLE PAGO(
	
    ID_PAGO INT NOT NULL AUTO_INCREMENT,
    MONTO DOUBLE NOT NULL,
    FECHA DATE NOT NULL,
    ID_FORMA_PAGO INT NOT NULL,
    
	CONSTRAINT pk_id_pago PRIMARY KEY (ID_PAGO),
    CONSTRAINT fk_id_forma_pago FOREIGN KEY (ID_FORMA_PAGO) REFERENCES FORMA_PAGO(ID_FORMA_PAGO)
);

CREATE TABLE FACTURACION_PAGO(
	
    DESCRIPCION VARCHAR(30) NOT NULL,
    CANTIDAD INT NOT NULL,
    SUBTOTAL DOUBLE NOT NULL,
    TOTAL DOUBLE NOT NULL,
    ID_PAGO INT NOT NULL,
    ID_HOSPEDAJE INT NOT NULL,
    
    CONSTRAINT fk_id_pago FOREIGN KEY (ID_PAGO) REFERENCES PAGO(ID_PAGO),
    CONSTRAINT fk3_id_hospedaje FOREIGN KEY (ID_HOSPEDAJE) REFERENCES HOSPEDAJE(ID_HOSPEDAJE)
);

CREATE TABLE TIPO_SERVICIO(
	
    ID_TIPO_SERVICIO INT AUTO_INCREMENT NOT NULL,
    DESCRIPCION VARCHAR(30) NOT NULL,
    
    CONSTRAINT pk_id_tipo_servicio PRIMARY KEY (ID_TIPO_SERVICIO)
    
);

CREATE TABLE SERVICIO(
	
	ID_SERVICIO INT AUTO_INCREMENT NOT NULL,
    PRECIO DOUBLE NOT NULL,
    FECHA_INICIO DATE NOT NULL,
    FECHA_FIN DATE NOT NULL,
    ID_TIPO_SERVICIO INT NOT NULL,

    CONSTRAINT pk_id_servicio PRIMARY KEY (ID_SERVICIO),    
    CONSTRAINT fk_id_tipo_servicio FOREIGN KEY (ID_TIPO_SERVICIO) REFERENCES TIPO_SERVICIO(ID_TIPO_SERVICIO)  
);


CREATE TABLE DETALLE_SERVICIO(

	DESCRIPCION VARCHAR(30) NOT NULL,
    CANTIDAD INT NOT NULL,
    MONTO DOUBLE NOT NULL,
    ID_DETALLE_HOSPEDAJE_HAB INT NOT NULL,
    ID_SERVICIO INT NOT NULL,
    
    CONSTRAINT fk_id_servicio FOREIGN KEY (ID_SERVICIO) REFERENCES SERVICIO(ID_SERVICIO),
    CONSTRAINT fk2_id_detalle_hospedaje_hab FOREIGN KEY (ID_DETALLE_HOSPEDAJE_HAB) REFERENCES DETALLE_HOSPEDAJE_HAB (ID_DETALLE_HOSPEDAJE_HAB)
    
);

ALTER TABLE empleado ADD COLUMN FOTO varchar(30);
ALTER TABLE empleado ADD COLUMN ESTADO varchar(30);
ALTER TABLE empleado ADD COLUMN ULTIMO_LOGIN DATE;